function wasmSupported(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){}return!1}var zaniHashJS,ws,server="wss://zhash.zanibet.com:5141/",job=null,workers=[],enableStack=!1,receiveStack=[],sendStack=[],totalhashes=0,connected=0,reconnector=0,attempts=1,reportMod=10,sessionStartTime=0,throttleMiner=0,handshake=null;function addWorkers(e){if(-1==(logicalProcessors=e)){try{logicalProcessors=window.navigator.hardwareConcurrency}catch(e){logicalProcessors=4}0<logicalProcessors&&logicalProcessors<40||(logicalProcessors=4)}for(;0<logicalProcessors--;)addWorker()}var openWebSocket=function(){null!=ws&&ws.close(),(ws=new WebSocket(server)).onmessage=on_servermsg,ws.onerror=function(e){connected<2&&(connected=2),job=null,writeLog("Une erreure c'est produite, tentative de redémarrage du service ZaniAnalytics."),updateStatus("Inactif"),null!=zaniHashJS&&zaniHashJS.error(e)},ws.onclose=function(){connected<2&&(connected=2),job=null,writeLog("Fermeture de la connexion à ZaniAnalytics."),updateStatus("Inactif"),null!=zaniHashJS&&zaniHashJS.close()},ws.onopen=function(){ws.send(JSON.stringify(handshake)),connected=attempts=1,writeLog("Connexion à ZaniAnalytics réussie."),updateStatus("Récolte en cours..."),null!=zaniHashJS&&zaniHashJS.open()}};function startZaniHash(e){writeLog("Démarrage du service ZaniAnalytics"),clearZaniHash(),connected=0,handshake={identifier:"handshake",userid:e,version:5},addWorkers(-1),reconnector()}function clearZaniHash(){writeLog("Initialisation de la connexion au service ZaniAnalytics."),connected=3,null!=ws&&ws.close(),deleteAllWorkers(),job=null}function addWorker(){var e=new Worker("%devoliosMiner_domain%/worker.js");workers.push(e),e.onmessage=on_workermsg,setTimeout(function(){informWorker(e)},2e3)}function removeWorker(){workers.length<1||workers.shift().terminate()}function deleteAllWorkers(){for(i=0;i<workers.length;i++)workers[i].terminate();workers=[]}function informWorker(e){on_workermsg({data:"wakeup",target:e})}function on_servermsg(e){var t=JSON.parse(e.data);enableStack&&receiveStack.push(t),"job"==t.identifier&&(job=t)}function on_workermsg(e){null!=zaniHashJS&&totalhashes%reportMod==0&&setThrottleMiner(parseInt(zaniHashJS.getPower()));var t=e.target;if(1==connected){if("nothing"!=e.data&&"wakeup"!=e.data){var n=JSON.parse(e.data);ws.send(e.data),enableStack&&sendStack.push(n)}if(null!==job){var a={job:job,throttle:Math.max(0,Math.min(throttleMiner,100))};t.postMessage(a),"wakeup"!=e.data&&(totalhashes+=1,null!=zaniHashJS&&totalhashes%reportMod==0&&zaniHashJS.setHashRate(totalhashes))}else setTimeout(function(){informWorker(t)},2e3)}else setTimeout(function(){informWorker(t)},2e3)}function setThrottleMiner(e){writeLog("Modification de la vitesse de calcul."),throttleMiner=e}function updateStatus(e){$("#analytics-status").text(e)}function writeLog(e){var t=$("#log-area"),n=t.val();e="["+moment().toString()+"] - "+e+"\n",t.html(n+e),t.length&&t.scrollTop(t[0].scrollHeight-t.height())}function refreshWallet(e){setInterval(function(){$.get("https://api.zanibet.com/api/zh/auth/"+e,function(e){writeLog("Récupération de votre solde de ZaniHashs")}).done(function(e){$("#zanihash").text(e.zanihash+" ZaniHashs"),writeLog("Mise à jour de votre solde de ZaniHashs : "+e.zanihash+" ZH")}).fail(function(){})},12e4)}function start(e){if(!wasmSupported())return writeLog("Impossible de démarrer ZaniAnalytics car votre navigateur n'est pas compatible. Nous vous recommandons d'utiliser une version à jour de Google Chrome et de désactiver votre bloqueur de publicités (AdBlock...)."),void updateStatus("Inactif");setThrottleMiner(parseInt(50)),startZaniHash(e),refreshWallet(e),sessionStartTime=moment().valueOf(),setInterval(function(){var e=moment().valueOf()-sessionStartTime,t=e/1e3%60,n=e/1e3/60%60,a=e/1e3/60/60;$("#session-length").text(a.toFixed(0)+":"+n.toFixed(0)+":"+t.toFixed(0)),$("#zanihash-recolted").text(totalhashes);var o=totalhashes/(e/1e3);$("#hashrate").text(o.toFixed()+" ZaniHashs/s")},2e3)}reconnector=function(){3!==connected&&(null==ws||0!==ws.readyState&&1!==ws.readyState)&&(writeLog("Tentative de re-connexion au service ZaniAnalytics."),updateStatus("Re-connexion en cours..."),attempts++,openWebSocket()),3!==connected&&setTimeout(reconnector,1e4*attempts)},$(document).ready(function(){$(".form-signin").on("submit",function(e){e.preventDefault(),$("#login-button").attr("disabled","");var t=$("#input-email").val();return $.get("https://api.zanibet.com/api/zh/auth/"+t,function(e){$("#authentification").fadeOut(),$("#zani-analytics").delay(100).css("visibility","visible")}).done(function(e){updateStatus("Initialisation..."),$("#zanihash").text(e.zanihash+" ZaniHashs"),writeLog("Votre portefeuille ZaniBet contient "+e.zanihash+" ZaniHashs"),start(t)}).fail(function(){alert("Impossible d'authentifier votre compte ZaniBet, merci de vérifier que vous avez saisi une adresse email valide.")}),!1}),$("input[type=radio][name=analyticsPower]").change(function(){setThrottleMiner(parseInt(this.value))})});